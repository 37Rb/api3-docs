(window.webpackJsonp=window.webpackJsonp||[]).push([[105],{622:function(a,e,s){"use strict";s.r(e);var t=s(8),n=Object(t.a)({},(function(){var a=this,e=a.$createElement,s=a._self._c||e;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h1",{attrs:{id:"frontmatter-title"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#frontmatter-title"}},[a._v("#")]),a._v(" "+a._s(a.$frontmatter.title))]),a._v(" "),s("TocHeader"),a._v(" "),s("TOC",{staticClass:"table-of-contents",attrs:{"include-level":[2,3]}}),a._v(" "),s("Fix",[a._v('The commands use "latest" for '),s("b",[a._v("version")]),a._v(" and need to be update.")]),a._v(" "),s("p",[a._v("Using Docker is the easiest way to both deploy an Airnode and to run an Airnode locally. There are two docker images for each: the deployer image and the client image.")]),a._v(" "),s("ul",[s("li",[a._v("The "),s("strong",[a._v("deployer image")]),a._v(" deploys the node in the form of serverless functions (e.g. AWS Lambda).")]),a._v(" "),s("li",[a._v("The "),s("strong",[a._v("client image")]),a._v(" is the node itself, containerized. The container can be run locally or deployed to the cloud (e.g. AWS EC2 or Lightsail).")])]),a._v(" "),s("p",[a._v("You would probably run the client image container locally while developing, and use the deployer image to deploy the serverless functions for production.")]),a._v(" "),s("h2",{attrs:{id:"client-image"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#client-image"}},[a._v("#")]),a._v(" Client Image")]),a._v(" "),s("ol",[s("li",[s("p",[a._v("Build the Docker image (you can skip this step and fetch the pre-built image).")]),a._v(" "),s("Tabs",{attrs:{type:"border-card"}},[s("Tab",{attrs:{label:"Linux/Mac"}},[s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("mv")]),a._v(" Dockerfile Dockerfile-deployer "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&&")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("mv")]),a._v(" Dockerfile-client Dockerfile "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&&")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\ndocker build "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(".")]),a._v(" -t api3/airnode-client:latest "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&&")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("mv")]),a._v(" Dockerfile Dockerfile-client "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&&")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("mv")]),a._v(" Dockerfile-deployer Dockerfile\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br")])])]),a._v(" "),s("Tab",{attrs:{label:"Windows"}},[s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("mv")]),a._v(" Dockerfile Dockerfile-deployer "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&&")]),a._v(" ^\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("mv")]),a._v(" Dockerfile-client Dockerfile "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&&")]),a._v(" ^\ndocker build "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(".")]),a._v(" -t api3/airnode-client:latest "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&&")]),a._v(" ^\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("mv")]),a._v(" Dockerfile Dockerfile-client "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&&")]),a._v(" ^\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("mv")]),a._v(" Dockerfile-deployer Dockerfile\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br")])])])],1)],1),a._v(" "),s("li",[s("p",[a._v("Ensure that your "),s("code",[a._v(".env")]),a._v(" file looks like "),s("a",{attrs:{href:"https://github.com/api3dao/airnode/blob/pre-alpha/packages/node/__dev__/.env.example",target:"_blank",rel:"noopener noreferrer"}},[a._v(".env.example"),s("OutboundLink")],1),a._v(" and is the current working directory.")])]),a._v(" "),s("li",[s("p",[a._v("Also ensure that "),s("a",{attrs:{href:"https://github.com/api3dao/airnode/blob/pre-alpha/packages/node/__dev__/config.json.example",target:"_blank",rel:"noopener noreferrer"}},[a._v("config.json"),s("OutboundLink")],1),a._v(" is also in the current working directory.\nNote that "),s("code",[a._v("nodeSettings.cloudProvider")]),a._v(" should be "),s("code",[a._v("local")]),a._v(".")])]),a._v(" "),s("li",[s("p",[a._v("The following command runs an airnode client that is invoked every minute")]),a._v(" "),s("Tabs",{attrs:{type:"border-card"}},[s("Tab",{attrs:{label:"Linux/Mac"}},[s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[a._v("docker run -it --rm "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n    --env-file .env "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n    -v "),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$(")]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("pwd")]),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v(")")])]),a._v(":/airnode/out "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n    api3/airnode-client:pre-alpha\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br")])])]),a._v(" "),s("Tab",{attrs:{label:"Windows"}},[s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[a._v("docker run -it --rm ^\n    --env-file .env ^\n    -v "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"%cd%"')]),a._v(":/airnode/out ^\n    api3/airnode-client:pre-alpha\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br")])])])],1)],1)]),a._v(" "),s("h2",{attrs:{id:"deployer-image"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#deployer-image"}},[a._v("#")]),a._v(" Deployer Image")]),a._v(" "),s("ol",[s("li",[a._v("Build the Docker image")])]),a._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[a._v("docker build "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(".")]),a._v(" -t api3/airnode-deployer:latest\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("ol",{attrs:{start:"2"}},[s("li",[s("p",[a._v("Ensure that your "),s("code",[a._v(".env")]),a._v(" file looks like "),s("a",{attrs:{href:"https://github.com/api3dao/airnode/blob/pre-alpha/packages/deployer/.env.example",target:"_blank",rel:"noopener noreferrer"}},[a._v(".env.example"),s("OutboundLink")],1),a._v(" and is the current working directory.")])]),a._v(" "),s("li",[s("p",[a._v("When running "),s("RouterLink",{attrs:{to:"/next/grp-providers/deployer-image.html#deploy"}},[a._v("deploy")]),a._v(" your "),s("code",[a._v("config.json")]),a._v(" and "),s("code",[a._v("security.json")]),a._v(" must be in the current working directory.\n(They are also needed for other commands temporarily.)")],1)]),a._v(" "),s("li",[s("p",[a._v("Run the image with one of the following commands:")])])]),a._v(" "),s("h3",{attrs:{id:"deploy"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#deploy"}},[a._v("#")]),a._v(" "),s("code",[a._v("deploy")])]),a._v(" "),s("Tabs",{attrs:{type:"border-card"}},[s("Tab",{attrs:{label:"Linux/Mac"}},[s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[a._v("docker run -it --rm "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  --env-file aws.env "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  -e "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("USER_ID")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$(")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("id")]),a._v(" -u"),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v(")")])]),a._v(" -e "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("GROUP_ID")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$(")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("id")]),a._v(" -g"),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v(")")])]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  -v "),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$(")]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("pwd")]),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v(")")])]),a._v("/output:/app/output "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  api3/deployer:latest deploy\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br")])])]),a._v(" "),s("Tab",{attrs:{label:"Windows"}},[s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[a._v("docker run -it --rm ^\n  --env-file .env ^\n  --env "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("COMMAND")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("deploy-first-time ^\n  -v "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"%cd%"')]),a._v("/output:/app/output ^\n  api3/deployer:latest deploy\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br")])])])],1),a._v(" "),s("h3",{attrs:{id:"remove"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#remove"}},[a._v("#")]),a._v(" "),s("code",[a._v("remove")])]),a._v(" "),s("Tabs",{attrs:{type:"border-card"}},[s("Tab",{attrs:{label:"Linux/Mac"}},[s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[a._v("docker run -it --rm "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  --env-file aws.env "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  -e "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("USER_ID")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$(")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("id")]),a._v(" -u"),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v(")")])]),a._v(" -e "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("GROUP_ID")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$(")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("id")]),a._v(" -g"),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v(")")])]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  -v "),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$(")]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("pwd")]),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v(")")])]),a._v("/output:/app/output "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n  api3/deployer:latest remove -r output/receipt.json\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br")])])]),a._v(" "),s("Tab",{attrs:{label:"Windows"}},[s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[a._v("docker run -it --rm ^\n  --env-file aws.env ^\n  -e "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("USER_ID")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$(")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("id")]),a._v(" -u"),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v(")")])]),a._v(" -e "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("GROUP_ID")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$(")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("id")]),a._v(" -g"),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v(")")])]),a._v(" ^\n  -v "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"%cd%"')]),a._v("/output:/app/output ^\n  api3/deployer:latest remove -r output/receipt.json\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br")])])])],1)],1)}),[],!1,null,null,null);e.default=n.exports}}]);